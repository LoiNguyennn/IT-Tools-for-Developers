@model IEnumerable<ITTools.Core.Models.Tool>
@{
    ViewData["Title"] = "Tools";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Tool Testing Interface</h1>

<link rel="stylesheet" href="~/css/tools.css" />

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <h2>Available Tools</h2>
            <ul class="list-group">
                @foreach (var tool in Model)
                {
                    <li class="list-group-item">
                        <strong>@tool.Name</strong>
                        <br />@tool.Description
                        <br /><small>Category: @(tool.Category?.Name ?? "Uncategorized")</small>
                        <br /><small>Status: @(tool.IsEnabled ? "Enabled" : "Disabled") - @(tool.IsPremium ? "Premium" : "Basic")</small>
                        <div class="mt-2">
                            <button class="btn btn-sm btn-primary select-tool"
                                    data-tool="@tool.Name">
                                Test Tool
                            </button>
							@if (User.IsInRole("Admin"))
							{
                                <a asp-controller="Admin" asp-action="EditTool" asp-route-id="@tool.Id"
                                   class="btn btn-sm btn-warning ml-2">
                                    Edit
                                </a>
							}
                        </div>
                    </li>
                }
            </ul>
        </div>

        <div class="col-md-6">
            <h2>Test Area</h2>
            <form id="toolForm">
                <div class="form-group">
                    <label for="toolName">Selected Tool:</label>
                    <input type="text" class="form-control" id="toolName"
                           name="toolName" readonly />
                </div>
                <div class="form-group">
                    <label for="input">Input:</label>
                    <textarea class="form-control" id="input" name="input"
                              rows="4" placeholder="Enter your input here"></textarea>
                </div>
                <button type="submit" class="btn btn-success">Execute</button>
            </form>

            <div id="resultArea" class="mt-3">
                <h3>Result:</h3>
                <pre id="result" class="border p-3"></pre>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Handle tool selection
            $('.select-tool').click(function () {
                const toolName = $(this).data('tool');
                $('#toolName').val(toolName);
                $('#result').text('');
            });

            // Handle form submission
            $('#toolForm').submit(function (e) {
                e.preventDefault();

                const toolName = $('#toolName').val();
                const input = $('#input').val();

                if (!toolName) {
                    alert('Please select a tool first');
                    return;
                }

                $.ajax({
                    url: '@Url.Action("Execute", "Tools")',
                    type: 'POST',
                    data: {
                        toolName: toolName,
                        input: input
                    },
                    success: function (response) {
                        $('#result').text(response.result);
                    },
                    error: function (xhr) {
                        $('#result').text('Error: ' + (xhr.responseJSON?.result || xhr.statusText));
                    }
                });
            });
        });
    </script>
}